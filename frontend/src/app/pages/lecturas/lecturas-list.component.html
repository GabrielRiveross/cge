<div class="container">
  <h1 class="page-title">Lecturas</h1>

  <div class="toolbar">
    <mat-form-field appearance="outline" class="medidor-input">
      <mat-label>ID de medidor</mat-label>
      <input matInput type="number" [(ngModel)]="idMedidor" />
    </mat-form-field>

    <div class="btn-row">
      <button mat-flat-button color="primary" type="button" (click)="buscar()">
        <mat-icon>search</mat-icon> Buscar
      </button>

      <!-- Enlace que navega al form de nueva lectura -->
      <a mat-flat-button color="accent" routerLink="/lecturas/nueva">
        <mat-icon>add</mat-icon> Nueva lectura
      </a>
    </div>
  </div>

  <!-- Tabla -->
  <table
    mat-table
    [dataSource]="data"
    [trackBy]="trackByLectura"
    class="mat-elevation-z1">

    <!-- Fecha (desde anio/mes) -->
    <ng-container matColumnDef="fecha">
      <th mat-header-cell *matHeaderCellDef> Fecha </th>
      <td mat-cell *matCellDef="let r"> {{ getPeriodo(r) }} </td>
    </ng-container>

    <!-- Lectura -->
    <ng-container matColumnDef="lectura">
      <th mat-header-cell *matHeaderCellDef> Lectura (kWh) </th>
      <td mat-cell *matCellDef="let r"> {{ r.lectura_kwh }} </td>
    </ng-container>

    <!-- Observación -->
    <ng-container matColumnDef="observacion">
      <th mat-header-cell *matHeaderCellDef> Observación </th>
      <td mat-cell *matCellDef="let r"> {{ r.observacion || '-' }} </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
  </table>

  <!-- Mensaje cuando no hay datos -->
  <p *ngIf="!data?.length" class="empty">
    No hay lecturas registradas para este medidor.
  </p>
</div>
