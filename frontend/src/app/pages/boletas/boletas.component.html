<div class="container container-narrow">
  <h1 class="page-title">Boletas</h1>

  <div class="card section">
    <div class="toolbar" style="margin:0">
      <mat-form-field appearance="outline">
        <mat-label>ID Cliente</mat-label>
        <input matInput type="number" [(ngModel)]="idCliente" (change)="guardarPref()">
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>AÃ±o</mat-label>
        <input matInput type="number" [(ngModel)]="anio">
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Mes</mat-label>
        <input matInput type="number" min="1" max="12" [(ngModel)]="mes">
      </mat-form-field>

      <div class="btn-row">
        <button mat-flat-button color="primary" (click)="generar()" [disabled]="loading">Generar boleta</button>
        <button mat-flat-button color="accent" (click)="listar()" [disabled]="loading">Refrescar</button>
      </div>
    </div>

    <p *ngIf="msg" class="mat-body-small" style="color:var(--danger)">{{ msg }}</p>
    <div *ngIf="loading">Cargando...</div>

    <table class="mat-mdc-table" *ngIf="boletas.length">
      <thead>
      <tr class="mdc-data-table__header-row">
        <th class="mdc-data-table__header-cell">ID</th>
        <th class="mdc-data-table__header-cell">Periodo</th>
        <th class="mdc-data-table__header-cell">kWh</th>
        <th class="mdc-data-table__header-cell">Total</th>
        <th class="mdc-data-table__header-cell">Acciones</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let b of boletas" class="mdc-data-table__row">
        <td class="mdc-data-table__cell">{{ b.id_boleta }}</td>
        <td class="mdc-data-table__cell">{{ b.mes | number:'2.0-0' }}/{{ b.anio }}</td>
        <td class="mdc-data-table__cell">{{ b.kwh_total }}</td>
        <td class="mdc-data-table__cell">${{ b.total_pagar }}</td>
        <td class="mdc-data-table__cell">
          <div class="btn-row center">
            <button mat-stroked-button color="primary" (click)="descargar(b.id_boleta)">
              <mat-icon>download</mat-icon> Descargar PDF
            </button>
          </div>
        </td>
      </tr>
      </tbody>
    </table>

    <p *ngIf="!boletas.length && !loading" class="empty">No hay boletas para mostrar.</p>
  </div>
</div>
